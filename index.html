<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>üîê Encrypted Page</title>
  <style>
    body {
      margin: 0; display: flex; justify-content: center; align-items: center;
      height: 100vh; background: #0b1220; font-family: sans-serif; color: #e2e8f0;
    }
    .card {
      background:#0f172a; padding:20px; border-radius:12px;
      box-shadow:0 8px 25px rgba(0,0,0,.5); width:300px; text-align:center;
      box-sizing: border-box; /* Added to fix sizing */
    }
    .input-container {
      margin: 10px 0;
      position: relative;
    }
    input { 
      width: 100%; 
      padding:10px; 
      border-radius:8px;
      border:1px solid #555; 
      background:#0b132b; 
      color:#fff; 
      box-sizing: border-box; /* This fixes the alignment issue */
    }
    button { 
      padding:10px 14px; 
      border:none; 
      border-radius:8px;
      background:#38bdf8; 
      color:#082032; 
      font-weight:600; 
      cursor:pointer; 
      width: 100%; /* Make button full width too */
    }
    #status { 
      margin-top:10px; 
      font-size:13px; 
      color:#94a3b8; 
    }
  </style>
</head>
<body>
  <div class="card">
    <h2>Enter Password</h2>
    <div class="input-container">
      <input type="password" id="password" placeholder="Password" />
    </div>
    <button id="unlockBtn">Unlock</button>
    <div id="status">Waiting...</div>
  </div>

  <!-- Load argon2-browser -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/argon2-browser/1.18.0/argon2-bundled.min.js"></script>
  <script>
  // === THIS IS YOUR ENCRYPTED PAGE CONTENT ===
  // Replace this string with your encrypted HTML (using your encryptor).
  const encryptedPage = `B7eD0gSaDYusQ71s_Efry9We4mi2lfWQ9b5TDoYwnU61JQlLHcOSTirycaz3lEkgRXPQweKia_pvhBDxg9p7nQEaGc0-h0OcbYmj3fTBavmnrbPOa2W_PwL6TgTPvuM36u97NAUBR3bVM9ne_CVCHBtSJtErV8PR6ihpUSVa_wFXrYiItpcqICquVIuvlrJ2dRzCj2aFY5MsMxJ3sqzIgdzH6sY5NkqXkbmu643ifzG9o9l6aObBrZWVfDEWCC0uM-JcDH9f9VkAUyOnnP_83HJUNlHEggQhoqOUyqj2DZO8D5ojmlowteedf39NwXk-U4-hjg-dy6yVLf2iwUzy9T67qdB2tcs4RtXY3M5jrhEY6J4stnQk59FJxvp7prOl1dZ-7pyRhfSDxsNoDY27UJ2PHoBGas6B9z1gSx75dfkQsrvvZIvVom1shaWPUmfhUHaOtqHozNitQ-EBz4oCs7JsMJ8Z-sBW8PuDHbukK58gZhprx6NKiK2-jXBcC0JhJX19Hy_zZwlhm4O_CPrPHBrqPwsS2_tVZT99WWmZCMjZpZ_vRaIg12_9569RsiICl-WUf7bZnPsNtdVzFCwrYl38SGPE1Nuu6wdYxAz1W33IqSarj7Aagx5Elyv2rgvEVxBt0w7iBIGE5SYM1pnet5-7c6by4iWWik13teBpmyRdytdQUdce5fEs2Ykoltu9loTaTan4jr0wr2AD0PyJmrdsZPWDBZEENJSpDj6qXMaTXiCB0K2P8fKo2xe16F3r6rOiDVJ1dri1dvhd_dFBdsLU7GKIsjJcKCFTJ8uH3KRLcGC6b5lqkhilFTTcb8tp1BLh6VAFfwn2PNrbyl8yB-B9OoPUbSq4OiHNyOfQO-y7XvzFJHWHnzOMgjspBs2pIodwb6K7XLSs8Nf6eQKvQ-GEXk-C1Z98Cyuio92Fh9I6iiQ7SZy9X_tGrB_f0zyuLfhbuqeO8jronaWrDvwTwwgfyHsNe-kx98bWVO2EV7rMrpFbn5Q-NsMRSam6omdK0y9xPJ8lfFAq6Ytdxi9Gleqlxi7m-WIEfYehTjNeYO6FIw12t_DTemBsGlRGx4NeO6srk-J6D-xqteBJXn8IxU5W9VuyKvamH2L9n6MQUj4kwrTwjdOy4ZSqLVfZBaw9_OthThAD-grYkohQbuJk8PRlIxZ2wCyeFI1dra7mOhus2dlLMiaVp2TAe-iQLjfjpl3vLaNLRa476ftfgh0M_NDF3EBqtLVk6zEoOYeimnY0YvI0CaHlEzqcBeEth5ZAVOEz3lX9H9gwClp9jcW1TfluP6TA9_szP4wLnfP9uc1zVbdJYWE2xBK0nmD7NU8m0sIQdpJWfX4OFtS2IP5ZbC0tTLVSgR7mX7B7xmTHuF9zT-pMgUMh5xv5zX5IX5dL9KZOxsLSPuLvhWL9lnyDprF8UoMAdoi0EO1VN7o2SNUQk1zG0frMBCjgcm3okZ0-7evq1yK1bjg7mF5J4KJIjbekmlX_4EwFLNMJc8X5FXuiA4cPNTwEX4k6OidS0pPuaNm-Smrjd88z4PHCPifeZP0ZDDe74XfIPN6PCBBsp0MCd39dOEH3XtaEsAMspCLSCqnn3pVFpLINmttb7abt2rgoAGiaXwI04lb5LHYMsMS-HiXBigVdi8YSUAqOpz3Exg-RsnAopJGHT73aWtyfgmsx3N-FQgDrkvA46tEai1qvaGdpXtSfLhQDnnHQQbC44-IjilFq_O8wNe2Gdr-atevB6KOUb0MApDpFxUkYl9pc7rursDp7sVg4OClooacQayA0L5OaZIB0GeID4hOIvBhmCgqKDDwhge22xtlvPOdTBuo3OUwbu0-FdyHeVQmCzAK5xCpAsHz53OAI-OwMC8V1v1NFW2N64kLn7sEQM7Qj6U3j3lwpIJ8slmWJgMk2VCOs4IgqjboC2-hDKal4JyfuCBXpOSfdbIy54oZk3hWK2Vlehar8P7EUVtHPuT97D4n-77csoCfvkcqy6yv9lebkPi4EKYyt3u3NgseoLfbmAZjXC4GGA0bZ8K_QAxguenSF4TqBii0wZg3NTNLdsIr4jlWLZZnKl4olvrCqFoCov06qP_zVdYO08CFCucZ7ibs3hYxOvJwC2a79ylYVvIbmiAEP0g7iMu7QppxW5VaAWLRh-d_T7BLF0p4aoxUGWGG2xmVBDEJjld4VRElOA3htp032hYDGcYMrzRVyOXfc785dEROCV4mVerNG_1YRYyK_TBc6bVXeJMksiyMgSDISB2MtTfkboChlvzh6glTlxkyAKpeWalPnpe8DFWFJmeNBIeCIoy2--UTdIJLEc6pv3cem6fjsiqSFbYli5AQS89gxvM4UF4ieK55pRLDzvYJHKesiSDO6ClsugKhMZnbNfO3nUe58YMZ5kppZ-pXQUrR9V7FQt2t2RyV1fxT1oOFYg8yRWyJuSEaCiUIB24s1-RaxLzSuVDNIlCtzUaoXvpu9H9RgAd3XVXwiBjJdceCBiOjW9rbDSIkLwgSG-F49eHbhRxnwaThRLz67sOE0ixQg910Iex1My1Xsy7SXc64SZkSh2Jsbu8J_ST-Yio4trix-vFRGGdrkrO8P7PzqnLP55LCLeq3bYVLhUvPFj7LWqP0aJ0eRK1136rqhHc8oFzjGlwhlZQ_eNTLrVY7I7bA1FFnzVmc4IZLRYcX2NYk8ddou0ebRd2pwQwNKDgpLnajbZt7t_SNLnnYzfFa93PfQALYM4n7W_ULf7yH2G0oTQplf9RLETzy7zkuVM4PNUK_CkKHeSpnVwSlQ4z2zp2__lDiuF9ErjD6mFTlFQVANTh3gpC_nRobFlN3juLLA-gX8jdGRZY9Xzrn0SYr2yqX3vRmmMHiI7bFY-nUDU6BGhqxoN09-nkcBCBJyiW3jH5O2LR6gcdQgkE6xN8dXKBEzJ3jxp8yYPO40ft8XShkeKwDEKUhtrMa4sqEaEWcIjeyMIAxiwqcAG7YS04oEKf-tOO8_Nk15I70NHPZCq7r75wQ1nllrGSnIIqV5Sf5gyxOc1RoRyJB53YLXu_BVrP80mTImhbC3-Nyjs2TPISfwKVCup-8TWrCrT4lWUuLni6u-8ZDlQWa3V8KPJPLUiF3oufvaTScInGdrpmCuNMbmRgLMlClK_-N_iczVtm46W2reM18RLvZESPMzRg7lKPonhE4eLe8RSZFE1wk4RQM7WYLYkKL44DmMTlEmm1DLzEae0V8fkB3XrCUvMNliL4kuhVPUlMeLQxg3UJ3useaH0zQWh16Ta4SMQTofTj2-1Eqa2gMf5YRLRTna3nmvKu59d52i4VRnvdacFdoSbRZkgPn5B3ow4_UQCvbSJCR3V3Fv3fXxu2q_gSvzK1U9mfrhs5StODGzHcm0LNzZ8VvXPWNGOjnmBNViafOlmMb-RMB7ZAEJtDIlEqKXHCV55H8X7cT4x0FktGknqd2ptd5XKPFR5IioqbRnVdChEtM3L9Pcvu1u9pSpmmZVrktboJ90DJdQqX7-Ghkd00de-5oBr2PAH3ZAtO3rA4_JfWUjLb6KJUjQJodj6NxIUf4rBYIFR79nxzmvHr3LZTYBS1vDaqiLIBeRdzMftrhB53htC6h6LzjrIr_q7kDHbnk9mt3LdL8sUGU0u8XW7MF18pSsqQZhDNDcJ77sKAlhxupEmZYtMUUahEL6lJVvax1JohrP2XkViMY9FzQCYnnSXe3WU1yi1ZT727Rd0MameLAorEkKxkq-KaoHl5Kqz3hEwOzOXv8RV8xJVbVR3Q5Q0Ayqa1YoSQ8TbFIf0tvd1OxGVtxM_Uhyf6I1q9nRYBETRkPokDGmz1VqNQxoTiA5RfTQByBcJriQ5BlpmrsTEi6p8-ABzv67sLHH6qJmefAOiwq1orR7UgAG-UCzZycnVy7LC45KCQx5hk6r4FbfFhoNl6psuJMgXUG0yEyutw2QnzYhqg2k-cOHQMq5A3H7k6nIEkPrFUdI9r5GwcWb0AQW7p9Ejm0eMudgS4dszoqR85GZ6l5WL9fjRoaR0ToatPxAkKe3Tz3CM8J4oObLkJBaOIzo72Z3amPug9BBUOlDzqgh6Z0R02lhtuuQj_siNZjhcOXXt2OHREbV16BH0h_JYDKUp_C2dyvfYwFPSSt_d-NqLMPK-MAc4yfKl8jxaemvs8_tY3T9hX8dO7_P0NJe7MoE7IrXaSlC5xUv5LuGdrE0jZ3kX56gxxW64iPvLFt6ViYZXlr3u3JDXT8AMT6I_pzCcTRdYChKfYbv7SUBjyGzXL6PuWvwJqP47pns5cTA8ONHMITTX4ezboo_eU7y5EKuWUMzF3QmsSzL-TgXMKM8VK8aAoaQRaI7jXf_1adtxhOimsu_pBjg-uaQRSvkuMBPoBq7GC5wE93RxwTAy97POxJL4HfU44QOLWSgjAZMiRYGtVzU1-t25bQnYJKZuw7I3ssccOlALZiy0wnPivT4iVfmVRZ6uzSFt_p2hlh1rFifQ3J5onR5X4Sl9QiD7FwD5-gRaZVLYn-OcHRckCnQRatwSf9eq8qpHY6o-z0wA3Ml3bJbzABg5qjWK5tpXlMhjtem0Cu8f0Rh7Y_66tWD4fyl3fx_AKrovPd2I-TcPvgbBn6XyW_Rz4m4xUiYAvaSKoF-N6d3n62GXrzY77Eix1Itu1OaOahp8-MHkPKv1lGqfqHldMMpegY5ywAhI8EGUuidYpQ7X2xstxayT8V_Xk_689ZAY6iIs4j4FqKP7mga59xBC_zogYzrBXxj2cFvKLMvcuVpoV3x8vbyjUNuA5NmMPyTg7XHse-r7lYpeDOBcSBWDUaMKZAsYnoQWLONc3ycaSsvej1y6kL6dMvVV0VRKIgmz8q0yKvWTs3MyLLF4-aCuFoXel9ELlD7b4qSmB1IYiXkce7Q8AXayZr2aX5P2Z6VWS_8TaBsl47yZ03XFmVup9-vILN9hnc3g-uXmedARzE2h7qF21ZTV16Kw2xEL-uYPVbtCWKkpPQGvKcbp1q3CpTUqbSfxxVFTNEV1SBJFklGh-Uf6nRrhjoXQXzc7NFnHUr_zkxHIfv6f8LxLbagINSXdlvwrJQAghYtWuybg62shpKBQPF8Vu7eTNz8rEwNMTUI9-FIko82RCB1a89g23xuxzqnGO_CgcIyKBZYyEDO1CMjcvF94nZuxiDtAd8teTVBTSVQJIdJrY8i3TX9hHdV3e0LqAAAuH0Jxw1MK5FJY4o6tSdAZDHCHmweTjWCrQeLT6nz9iGysHpZbY97p3KIS45G_HHogMIWPaGzp3kmpM_tukMcyjSKJ4NwM01yTeoelZlnXFu7VF5Ck9O9f6gJzGysfxEa4klqDNTWIhnd-XndNUetWaa9Up2_W46rQ9l80BjCr4TXKhLD8nkGi8zxp3rxXqFPVwtAz4Cl7ee5oA8Z4PEUyI6JL4skVR-3WBAeKL8NDhTwabWKv9OBImIKG7WDIRiUBtHQ1G4lE7K6bh84LYnO9fjELZou9G-qwyemiGUjqG38Akk8QiC8qOwPWZ3kkceS2hfa3cVLejYc0AqO38uYVz0eHjqPkOoufnyGXU1CUbPBFyPOl2n3Qg2PiMI2pcHv7sKL77C4eFH4mltIGkrzcdp9lHAyJSfAiLj92eKoDp4RdYtyGQvBRx_JSuYjMeWxbkuJXkKQ4kGGTKRcZ6HPJ6R3IX7DERYyziNM2oifWcMnzYaZdQprGhG5klTmGtdSNa-cbvSqEJ6Naa-WvYY5LBWsapW99c5gZuPmmfkQnBkLbv7lX5aEdldfxSFaEwhGkY9d-TmgOfvxozExyDZ0dxun5scZYevSNCqxeL_4rMSMC2HfZc_vZjS8TpbJdNsiglaUb6LeqmehPWfxyWM3ERTTvplFJvldLOGdXVxUXwewkzebhRK_ron5LTO9CAC0mdEPc6Zbr_l7ApSOoP0NDGVmxziekTVDt0A7aTyqND6V-TQmcXyNJnjcGw-QuPrNGce2evTJuC69kMpXuhzw_1e4TIb5jKWU7Cgs_1cZy94qek-paABhWNsY2VrhTaMdJ-XskiOTC6KLsXFkbnWfOeBcRaOImXTs8kaARqMD5kR8TCV9cvr4F1XsNpxLb7SqFNa_MyX5YmZ8NwAseqybmMTWeorroPREil7KLQBvqlXmcJ3xalyBxEBOAHc6Sago1lM8S_i_DbCERI1mHhDf40efm8OpYAtudvTZrgS2nQVv_HK81KR_6QluaemZ7Gqa4xVYiWxIimZmreeyAhoThx8MKrbSocOSLFz8NPR7WC9XB9czaV4kYqrhgLMXgdVk9etBeyX5BBcWo5K2t74ZPMbX5ExsaTrmgkfXDmoF39qn0RS9wlDM-UpT41PIXdd4T77XIy7H2igW-5ueRqc-gZU_BwYgh4_412U10TLyaOmbhXWSSHQ73Hknds_CdPKD1JD0VjiDW8W4Y0i8pimDpzcI_EA38WLIp6HRX7MP29Joe84XazajS9eeV6y3SjYxnibuUk0GfoFDjBh_xTniqKyvcRC7S9Sj234tVCWKhRQic1obny2QerUj2-0-Xq33bOQ8ZVKP7v49NgJzGs9tzBC1UYBLtneI24vcASp5VLiSJqaNBqt6oHM8EBQFQrXiEipdKlXrjXGVOsYyvEfPHIh9GnLGXHxKnlKjKBb5XX8gQtKdUb9CqzThcENWuAbEYWlw5eTscjkbDjDIsGCseHqZhT2WY8m3hPJGMYyO9n_X0Ie4wf0hiXqvbP0HHTAtncPj85-xFusm4vvjzw1qjROHwdK2TOM6MkCU3dcHAg3FB-aSo0rWbel671lRoaRVJKNhu4VvnmbT8EcuWdKUqhBUJkO9VBF6v0v6AIwNGrv7mYyu3YvgET7ChPSm-dUnFpN9887lqEskHT4VbtUnZRmlce1zqanJTDyGdmKRrFKQagzCFr1GO244_YgXAXMEEDU9b8qWmX-_vEseo6f-mBuEX8y8spZkg6Fjj7mkQIYBH1wtxMXkL3QQwze1TXtAI9i7v18i5opv24zZaB_qVaOAopIVkbYMwQy9a7C4t6NheRROpduHg81_iTCkObyJmZuCAqmeqcpSCMEFx0e-7GVEPB689lS_ceVFhTpAcTsNdn2YoxdPe9DUiwoo3rcUjTlhco2M2qp1dqKlwUQVdN19HM0luaAveyeh9vJhOfZwxbRNtfeqeG-gsoqxUWbE40YBXOCGHcSeebskdIEriI9iVfxEtFTYEqkdJt3mw1rAXSmqFeJawcWD9wJrpZGZXtCf8J6fgrv0qEz_-JQ_TFzGN4ainoHaOGzZgyocqvKxOBBDwTgT2HBf3MobDHDhjFhR71lmtIjQORfgbNOS9mhoxnCY2Z3rHCZUMA3iebn2mOkppLRE_gX_zeqloljnE7uCgjPy1m8IMps4rJkF-cgfZuuFAl_beP9eImkXofVxbOeukvzb8Yh0pOQ16gKBVXD5DvJFKPyOswIW1_Eh_Qx5tKE4FRuEsKk6lciuY1aN5i_YjJ26n1CRxfZ3oNlWm9rvcrGQzlg4C_RJb57myWov9RAV2ybPBGewGDTebMUL3LxC_Hu7hRP5pThZOELE_DuMcHz10IlgHSFb5ANfE8oGCCQRkw0-paPuSMsmQAz7QqRRNEFvNDsbmnUhSSo3Kx9HWZc-R9a1-ngcSIpqXbh6Vu92WIyFInyZJZLc9wPFAWKzjQ_vx_FwZ8WWd4bkAfwUEgPxtehQitRRe27g9031vo4XAYKYsj1axEMNX52UItny3JkNrwME-TDaGQqwGS1ZUf_eEdjgozjVviOkVC5vDcYWaoEN5Nq0oZiIoWuCWU0s9mwQ7MEPQvWZusbBvEpzyHjtedKuShxzRcW0TEY--D8rNt2hXmrOo3gC2LrCpcV4HR_eKHcub58GQ2fLbOOItpfUkxVYwuvOmkF1tlrGRtfCj7VfTB3AklMhPu823O4u4ZkcT22n5z2GYiwpfUc4XXehr6mA17T-hhhwK_ObPgVTpzH2__Rgezk5PaXPSomZvXqreKXn_IDXMChb3-WUUVBC33ZK1ZsD4SA4fIqOWli9kvy6RZLkx7_gbjcqWsy537VxrCj7CxALwmjX_MGlo6jDfvwGZViu-TEzpT2tYR-ZEwQGrU4af46z2ZcItdQl-oOd9aXAu4hhDFQlbSX9JvAydfVHYmQMxaZhCV0hrD0rkruWIRxha5gfw6kiQbFuCOvi8hamChxrlTE6-Ndob4eST-phuP8HdMj4mprQr2-dYXVPJ2SkHZJr2c2n-ASzUtkVjaAENlWNcct1jxTAKTSlUo8MCobBv1zjf2gDjvwf_Rkke1mXWUyvImW-bHsFCwMQwbA5HbibLnCgK2L_ijnnHZJg4WuvpmlDu0SYeXlTsKj_5eQxuG0j6J24orcER04Qmcph2ukQBnfJs7s3Wk_O9gCXwTAId3Qa7BXh6P3HoeQDHWYe-ucb-bBEO_Hgp1h2LTRbOPMGCAyt79_Ir4YzdR2C9SJ5DHXxpprHfgM3halL8LD0lbNzqqBz-qGCLNVK4lJ2W2HETH2z1k1C5VDUXk8SH8v87U2Amey_eT26ycIh-tkZmhb3jlhu6Y136g1zIaB6EqF4BaUDxLsWLuXMyE2EKo-kUbffRJrVOKmiQiKjDdqz8B1YK4uIM1HVPb0dtsfFP2rn9alBtl9nu-LinZ_KN9dYvIAynUR2LvRpQLm7ztEXL4AWdO8FbHn2VqLOBJ5QK6UVKRezpE-wkQJzCUiyqH4Sj4QkNrz4Tkhdpx6BG0y932ftYuEpRHQTUKZB_Cd__r8Fg0kFZIPlnZs3hONFVIVwuaOIaJD0xz2M1Q1KGUDZwXIalykoKncYPvPatYQ7MO6Ihgib0Ij4XGadRowjzEx_1GhFmEWrZmL-oWlnOCZTFCieyUgROgrtT9sIKTNwlYWkipMDPkLthSPngqPUWFFHHzDyiMwhl9QOe1-Fa_cmW-P_HaX_LcfGpDewNjIMboo808vjWGePKqXGC_g5E8Pt27qbMSaXF2j2eXCYL9ZrSsrHsNBsfEcY8NcMW6JMELqHswdSbSYcRh1I3go5Y0u9affawIRluA4YCYjRUl_Sc_Bh04RmQ1rO2ZsxIINS7q2yrNqxaE2nOXEcsgKsq-AtJlYCIBkPGPH7nU_cF_1Lbd9eum6mMA18wNZmaVkrLEgdijiKMtu6MParGCtH2_bV18cnki1xzLUFIEwcEK7OAOC3zhpgqQJ8rYYLbCi-ZFL_5Tpqf-T40fSwN17INtiAREbw0vN5-qyQwa4FkdOg4HGYHqyrQO5gbdGkbQtB7GVFICskpqODczEfo6AJ0Xp6h8lAiBGr3MvzamjsIAwt49pOy9pOkSpS7o9GIkF_cMSWnRlaysFWOpBQMtU9_pECDxXFV6ddzk0_dBoVvPI3UETzcd6JZ_QzV-SlYWDNhQkH0wepIH7JoPVsuTb91Lz4CtDy_j36a9JHdtPxaFPyWBEQthzDuGTfkQZJDqDAqyr6s8b7BIk_TVGHPbFwJ3gXya-6wRRKthPhYhnMyijYArCF8I9_K_te0d3cG3NXurFMhiuRIwO96aY-8Sr-oXpo69EgarAjfVsWp-O8cSpq5LzSqLqW_rVEC7BJIOahSa13GVpFYzo6KYf_SK60lradbOtDFFsJAVuotF8Cup64ZAhEEzJWwGYCI6MItStnLwSu6oZ4XAyjC2YTkvzArde2x2ccXTz9uk_CzAuM0qmkTGU`;

  const argonParams = { time: 3, mem: 524288, parallelism: 1 };
  const dec = new TextDecoder();

  function b64UrlDecode(str){
    let s = str.replace(/-/g,'+').replace(/_/g,'/');
    const pad = (4 - (s.length % 4)) % 4;
    s += '='.repeat(pad);
    return Uint8Array.from(atob(s), c => c.charCodeAt(0));
  }

  async function deriveKey(pass, salt){
    const { hash } = await argon2.hash({
      pass, salt,
      time: argonParams.time, mem: argonParams.mem,
      hashLen: 32, parallelism: argonParams.parallelism,
      type: argon2.ArgonType.Argon2id
    });
    return crypto.subtle.importKey('raw', hash, { name: 'AES-GCM' }, false, ['decrypt']);
  }

  async function unlock(){
    const pw = document.getElementById('password').value;
    const status = document.getElementById('status');
    if(!pw) return status.textContent = "Enter a password.";

    try {
      const bytes = b64UrlDecode(encryptedPage);
      const salt = bytes.slice(0,16);
      const iv   = bytes.slice(16,28);
      const ct   = bytes.slice(28);
      status.textContent = "Deriving key...";
      const key = await deriveKey(pw, salt);
      const pt = await crypto.subtle.decrypt({name:'AES-GCM', iv}, key, ct);
      const html = dec.decode(pt);

      // Replace body with decrypted HTML
      document.open();
      document.write(html);
      document.close();
    } catch(err){
      status.textContent = "‚ùå Wrong password or corrupted data.";
    }
  }

  document.getElementById('unlockBtn').addEventListener('click', unlock);
  </script>
</body>
</html>
